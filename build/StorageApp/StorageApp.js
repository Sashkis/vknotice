var StorageApp;!function(t){var e=function(){function t(t,e){var r=this,o=t.defer();this.$rootScope=e,this.ready=o.promise,chrome.storage.local.get(function(t){r.stg=angular.copy(t),e.$apply(),o.resolve(r.stg)})}return t.prototype.onChanged=function(t){var e=this;chrome.storage.onChanged.addListener(function(r){t(r,e.stg),e.$rootScope.$apply()})},t.prototype.set=function(t,e){void 0===e&&(e=function(){}),angular.extend(this.stg,angular.copy(t)),chrome.storage.local.set(t,e)},t.prototype.getProfileIndex=function(t){if(t&&this.stg&&this.stg.profiles)for(var e=0;e<this.stg.profiles.length;e++)if(this.stg.profiles[e].id==t)return e;return-1},t.prototype.getProfile=function(t){var e=this.getProfileIndex(t);return e>=0&&this.stg.profiles&&this.stg.profiles[e]?this.stg.profiles[e]:{}},t.prototype.setProfiles=function(t){var e=this;angular.isArray(t)&&t.map(function(t){if(t&&t.id){var r=e.getProfileIndex(t.id);e.stg.profiles||(e.stg.profiles=[]),r>=0?e.stg.profiles[r]=t:e.stg.profiles.unshift(t)}})},t.prototype.clearProfiles=function(t){return 0!==t&&this.stg.profiles?(this.stg.profiles=this.stg.profiles.filter(function(t){return t&&t.id}),this.stg.profiles.length>t?this.stg.profiles=this.stg.profiles.slice(0,t):this.stg.profiles):this.stg.profiles=[]},t}();t.StorageService=e}(StorageApp||(StorageApp={}));var StorageApp;!function(t){angular.module("StorageApp",[]).service("storage",["$q","$rootScope",t.StorageService])}(StorageApp||(StorageApp={}));